"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[230],{85001:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>s,metadata:()=>r,toc:()=>d});var n=a(87462),i=(a(67294),a(3905));const s={sidebar_position:5},l="\u5982\u4f55\u521b\u5efa\u6a21\u677f",r={unversionedId:"tutorials/how-to-create-template",id:"tutorials/how-to-create-template",title:"\u5982\u4f55\u521b\u5efa\u6a21\u677f",description:"\u672c\u6559\u7a0b\u4ecb\u7ecd\u5982\u4f55\u521b\u5efa Walrus \u963f\u91cc\u4e91 EC2 \u6a21\u677f\u5e76\u4f7f\u7528\u5b83\u5728\u963f\u91cc\u4e91\u4e0a\u521b\u5efa ECS \u5b9e\u4f8b\u670d\u52a1\u3002",source:"@site/i18n/zh/docusaurus-plugin-content-docs/current/tutorials/how-to-create-template.md",sourceDirName:"tutorials",slug:"/tutorials/how-to-create-template",permalink:"/docs/zh/tutorials/how-to-create-template",draft:!1,editUrl:"https://github.com/seal-io/docs/edit/main/docs/tutorials/how-to-create-template.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"docs",previous:{title:"\u96c6\u6210 CICD \u5de5\u5177",permalink:"/docs/zh/tutorials/integrate-with-cicd"},next:{title:"\u4f7f\u7528 OpenTofu \u8fdb\u884c\u90e8\u7f72",permalink:"/docs/zh/tutorials/deploy-with-opentofu"}},o={},d=[{value:"\u524d\u63d0\u6761\u4ef6",id:"\u524d\u63d0\u6761\u4ef6",level:2},{value:"\u5728 GitHub \u4e0a\u521b\u5efa\u4ed3\u5e93",id:"\u5728-github-\u4e0a\u521b\u5efa\u4ed3\u5e93",level:2},{value:"\u521b\u5efa\u6a21\u677f\u6587\u4ef6",id:"\u521b\u5efa\u6a21\u677f\u6587\u4ef6",level:2},{value:"\u63d0\u4ea4\u6a21\u677f\u7248\u672c",id:"\u63d0\u4ea4\u6a21\u677f\u7248\u672c",level:2},{value:"\u5728 Walrus \u4e0a\u521b\u5efa\u6a21\u677f",id:"\u5728-walrus-\u4e0a\u521b\u5efa\u6a21\u677f",level:2}],u={toc:d};function p(e){let{components:t,...s}=e;return(0,i.kt)("wrapper",(0,n.Z)({},u,s,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"\u5982\u4f55\u521b\u5efa\u6a21\u677f"},"\u5982\u4f55\u521b\u5efa\u6a21\u677f"),(0,i.kt)("p",null,"\u672c\u6559\u7a0b\u4ecb\u7ecd\u5982\u4f55\u521b\u5efa Walrus \u963f\u91cc\u4e91 EC2 \u6a21\u677f\u5e76\u4f7f\u7528\u5b83\u5728\u963f\u91cc\u4e91\u4e0a\u521b\u5efa ECS \u5b9e\u4f8b\u670d\u52a1\u3002"),(0,i.kt)("h2",{id:"\u524d\u63d0\u6761\u4ef6"},"\u524d\u63d0\u6761\u4ef6"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"\u4e00\u4e2a\u7528\u4e8e\u5b58\u50a8\u6a21\u677f\u7684 GitHub \u4ed3\u5e93\u3002"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"/deploy/standalone"},"\u90e8\u7f72 Walrus"),"\u3002")),(0,i.kt)("h2",{id:"\u5728-github-\u4e0a\u521b\u5efa\u4ed3\u5e93"},"\u5728 GitHub \u4e0a\u521b\u5efa\u4ed3\u5e93"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"\u5728 GitHub \u4e0a\u521b\u5efa\u4f60\u81ea\u5df1\u7684\u65b0\u4ed3\u5e93\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u4ed3\u5e93 ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/walrus-catalog-demo/demo"},"demo")),(0,i.kt)("li",{parentName:"ol"},"\u5c06\u4ed3\u5e93\u514b\u9686\u5230\u4f60\u7684\u672c\u673a\u3002")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"git clone git@github.com:walrus-catalog-demo/demo.git\n")),(0,i.kt)("h2",{id:"\u521b\u5efa\u6a21\u677f\u6587\u4ef6"},"\u521b\u5efa\u6a21\u677f\u6587\u4ef6"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"\u8fdb\u5165\u514b\u9686\u7684\u4ed3\u5e93\u76ee\u5f55\u3002")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"cd demo\n")),(0,i.kt)("p",null,"\u5728\u76ee\u5f55\u4e2d\u521b\u5efa\u5982\u4e0b\u6587\u4ef6:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"- demo\n  - main.tf\n  - outputs.tf\n  - variables.tf\n  - README.md\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"main.tf")," \u6587\u4ef6\u5b9a\u4e49\u4e86\u8981\u521b\u5efa\u7684\u8d44\u6e90\uff0c\u8fd9\u91cc\u6211\u4eec\u4e3a\u6a21\u677f\u5b9a\u4e49\u4e86\u4e00\u4e2a\u963f\u91cc\u4e91 ECS \u5b9e\u4f8b\u7684\u8d44\u6e90\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'resource "alicloud_instance" "example" {\n  instance_name        = "demo-instance"\n  instance_type        = var.instance_type\n  image_id             = var.image_id\n  system_disk_category = var.system_disk_category\n  system_disk_size     = var.system_disk_size\n  internet_charge_type = var.internet_charge_type\n  internet_max_bandwidth_out = var.internet_max_bandwidth_out\n\n  vswitch_id = data.alicloud_vswitches.default.vswitches.0.id\n\n  host_name = var.hostname\n  key_name = "seal-demo"\n\n  security_groups = [\n    data.alicloud_security_groups.default.groups.0.id\n  ]\n}\n\ndata "alicloud_vpcs" "default" {\n  name_regex = "default"\n}\n\ndata "alicloud_vswitches" "default" {\n  vpc_id = data.alicloud_vpcs.default.vpcs.0.id\n}\n\ndata "alicloud_security_groups" "default" {\n  name_regex = "default"\n}\n\nresource "null_resource" "health_check" {\n  depends_on = [\n    alicloud_instance.example\uff0c\n  ]\n}\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"variables.tf")," \u6587\u4ef6\u5b9a\u4e49\u4e86\u6a21\u677f\u4e2d\u4f7f\u7528\u7684\u53d8\u91cf\uff0cWalrus \u5c06\u4f7f\u7528\u8fd9\u4e9b\u53d8\u91cf\u4e3a\u7528\u6237\u751f\u6210\u6a21\u677f\u586b\u5199\u8868\u5355\u3002"),(0,i.kt)("p",null,"Walrus \u901a\u8fc7 ",(0,i.kt)("inlineCode",{parentName:"p"},"@label")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"@group")," \u6ce8\u91ca\u6765\u5b9a\u4e49\u53d8\u91cf\u7684\u6807\u7b7e\u548c\u7ec4\u3002 \u53ef\u9009\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"@options")," \u6ce8\u91ca\u7528\u4e8e\u5b9a\u4e49\u53d8\u91cf\u7684\u4e0b\u62c9\u9009\u9879\uff0c \u5982\u679c\u6ca1\u6709\u5b9a\u4e49 @options \u6ce8\u91ca\uff0c\u5219\u8be5\u53d8\u91cf\u5c06\u5728\u8868\u5355\u4e2d\u663e\u793a\u4e3a\u6587\u672c\u6846\u3002 \u5173\u4e8e\u6a21\u677f\u53d8\u91cf\u6ce8\u91ca\u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\u53ef\u4ee5\u5728",(0,i.kt)("a",{parentName:"p",href:"/operation/template#variable-style-extension"},"\u8fd9\u91cc"),"\u67e5\u770b\u3002"),(0,i.kt)("p",null,"\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5b9a\u4e49\u4e86\u4e24\u4e2a\u7ec4: ",(0,i.kt)("inlineCode",{parentName:"p"},"\u57fa\u7840")," \u548c ",(0,i.kt)("inlineCode",{parentName:"p"},"\u9ad8\u7ea7"),"\uff0c\u5b83\u4eec\u5c06\u5728\u521b\u5efa\u670d\u52a1\u7684\u6a21\u677f\u8868\u5355\u4e2d\u4ee5\u4e24\u4e2a\u9009\u9879\u5361\u7684\u5f62\u5f0f\u663e\u793a\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'# @label "\u5b9e\u4f8b\u89c4\u683c"\n# @group "\u57fa\u7840"\nvariable "instance_type" {\n  description = "The instance type of the ECS instance"\n  default     = "ecs.s6-c1m2.small"\n}\n\n# @label "VM\u955c\u50cfid"\n# @group "\u57fa\u7840"\nvariable "image_id" {\n  description = "The ID of the image used to launch the ECS instance"\n  default     = "ubuntu_18_04_x64_20G_alibase_20230208.vhd"\n}\n\n# @label "\u7cfb\u7edf\u78c1\u76d8\u7c7b\u578b"\n# @group "\u57fa\u7840"\n# @options ["ephemeral_ssd"\uff0c "cloud_efficiency"\uff0c "cloud_ssd"\uff0c "cloud_essd"\uff0c "cloud"\uff0c "cloud_auto"]\nvariable "system_disk_category" {\n  description = "The category of the system disk"\n  default     = "cloud_efficiency"\n}\n\n# @label "\u7cfb\u7edf\u76d8\u5927\u5c0f"\n# @group "\u57fa\u7840"\nvariable "system_disk_size" {\n  description = "The size of the system disk\uff0c value range: [20\uff0c 500]"\n  default     = 40\n}\n\n# @label "\u4e3b\u673a\u540d"\n# @group "\u57fa\u7840"\nvariable "hostname" {\n  type        = string\n  description = "The hostname of the ECS instance"\n  default     = ""\n}\n\n# @label "\u7f51\u7edc\u8ba1\u8d39\u7c7b\u578b"\n# @group "\u9ad8\u7ea7"\n# @options ["PayByTraffic"\uff0c "PayByBandwidth"]\nvariable "internet_charge_type" {\n  description = "The billing method of the public network bandwidth"\n  default     = "PayByTraffic"\n}\n\n# @label "\u6700\u5927\u51fa\u53e3\u5e26\u5bbd(MB)"\n# @group "\u9ad8\u7ea7"\nvariable "internet_max_bandwidth_out" {\n  description = "The maximum outbound bandwidth of the public network"\n  default     = 5\n}\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"outputs.tf")," \u6587\u4ef6\u5b9a\u4e49\u4e86\u6a21\u677f\u7684\u8f93\u51fa\uff0c\u5b83\u4eec\u5c06\u5728\u670d\u52a1\u521b\u5efa\u540e\u4f5c\u4e3a\u670d\u52a1\u7684\u8f93\u51fa\u53c2\u6570\u67e5\u770b\uff0c\u5e76\u4e14\u53ef\u4ee5\u88ab\u5176\u4ed6\u670d\u52a1\u5f15\u7528\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'output "public_ip" {\n  value = alicloud_instance.example.public_ip\n}\n\noutput "primary_ip_address" {\n  value = alicloud_instance.example.primary_ip_address\n}\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"README.md")," \u6587\u4ef6\u662f\u6a21\u677f\u7684\u63cf\u8ff0\u3002\u5728\u4f7f\u7528\u6b64\u6a21\u677f\u521b\u5efa\u670d\u52a1\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6a21\u677f\u8be6\u60c5\u9875\u9762\u67e5\u770b\u8be5\u6a21\u677f\u7684\u5177\u4f53\u529f\u80fd\u53c2\u6570\u53ca\u5b9a\u4e49\u3002\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5de5\u5177 ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/terraform-docs/terraform-docs"},"terraform-docs"),"\u6765\u751f\u6210\u6a21\u677f\u7684\u63cf\u8ff0\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-markdown"},"terraform-docs markdown . > README.md\n")),(0,i.kt)("p",null,"\u751f\u6210\u7684 ",(0,i.kt)("inlineCode",{parentName:"p"},"README.md")," \u6587\u4ef6\u5982\u4e0b:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'## Requirements\n\nNo requirements.\n\n## Providers\n\n| Name | Version |\n|------|---------|\n| <a name="provider_alicloud"></a> [alicloud](#provider\\_alicloud) | n/a |\n| <a name="provider_null"></a> [null](#provider\\_null) | n/a |\n\n## Modules\n\nNo modules.\n\n## Resources\n\n| Name | Type |\n|------|------|\n| [alicloud_instance.example](https://registry.terraform.io/providers/hashicorp/alicloud/latest/docs/resources/instance) | resource |\n| [null_resource.health_check](https://registry.terraform.io/providers/hashicorp/null/latest/docs/resources/resource) | resource |\n| [alicloud_security_groups.default](https://registry.terraform.io/providers/hashicorp/alicloud/latest/docs/data-sources/security_groups) | data source |\n| [alicloud_vpcs.default](https://registry.terraform.io/providers/hashicorp/alicloud/latest/docs/data-sources/vpcs) | data source |\n| [alicloud_vswitches.default](https://registry.terraform.io/providers/hashicorp/alicloud/latest/docs/data-sources/vswitches) | data source |\n\n## Inputs\n\n| Name | Description | Type | Default | Required |\n|------|-------------|------|---------|:--------:|\n| <a name="input_hostname"></a> [hostname](#input\\_hostname) | The hostname of the ECS instance | `string` | `""` | no |\n| <a name="input_image_id"></a> [image\\_id](#input\\_image\\_id) | The ID of the image used to launch the ECS instance | `string` | `"ubuntu_18_04_x64_20G_alibase_20230208.vhd"` | no |\n| <a name="input_instance_type"></a> [instance\\_type](#input\\_instance\\_type) | The instance type of the ECS instance | `string` | `"ecs.s6-c1m2.small"` | no |\n| <a name="input_internet_charge_type"></a> [internet\\_charge\\_type](#input\\_internet\\_charge\\_type) | The billing method of the public network bandwidth | `string` | `"PayByTraffic"` | no |\n| <a name="input_internet_max_bandwidth_out"></a> [internet\\_max\\_bandwidth\\_out](#input\\_internet\\_max\\_bandwidth\\_out) | The maximum outbound bandwidth of the public network | `number` | `5` | no |\n| <a name="input_system_disk_category"></a> [system\\_disk\\_category](#input\\_system\\_disk\\_category) | The category of the system disk | `string` | `"cloud_efficiency"` | no |\n| <a name="input_system_disk_size"></a> [system\\_disk\\_size](#input\\_system\\_disk\\_size) | The size of the system disk\uff0c value range: [20\uff0c 500] | `number` | `40` | no |\n\n## Outputs\n\n| Name | Description |\n|------|-------------|\n| <a name="output_primary_ip_address"></a> [primary\\_ip\\_address](#output\\_primary\\_ip\\_address) | n/a |\n| <a name="output_public_ip"></a> [public\\_ip](#output\\_public\\_ip) | n/a |\n')),(0,i.kt)("h2",{id:"\u63d0\u4ea4\u6a21\u677f\u7248\u672c"},"\u63d0\u4ea4\u6a21\u677f\u7248\u672c"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'git add .\ngit commit -m "add template files"\ngit push -u origin main\n')),(0,i.kt)("p",null,"\u4e3a\u6a21\u677f\u521b\u5efa\u4e00\u4e2a\u6807\u7b7e\u4f5c\u4e3a\u7248\u672c\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"git tag v0.0.1\ngit push --tags\n")),(0,i.kt)("h2",{id:"\u5728-walrus-\u4e0a\u521b\u5efa\u6a21\u677f"},"\u5728 Walrus \u4e0a\u521b\u5efa\u6a21\u677f"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00 Walrus \u5e76\u767b\u5f55\u3002"),(0,i.kt)("li",{parentName:"ol"},"\u8f6c\u5230 ",(0,i.kt)("inlineCode",{parentName:"li"},"\u8fd0\u7ef4\u4e2d\u5fc3")," \u4e0b\u7684\u6a21\u677f\u7ba1\u7406\uff0c\u4f7f\u7528\u6211\u4eec\u521a\u521a\u521b\u5efa\u7684\u6a21\u677f\u65b0\u5efa\u4e00\u4e2a\u6a21\u677f\uff0c\u8fd9\u91cc\u6211\u4eec\u5c06\u6a21\u677f\u547d\u540d\u4e3a ",(0,i.kt)("inlineCode",{parentName:"li"},"aliyun-ec2"),"\u3002\n",(0,i.kt)("img",{alt:"create-template",src:a(35670).Z,width:"2532",height:"1262"}),"\n\u5bfc\u5165\u4efb\u52a1\u5b8c\u6210\u540e\uff0c\u6a21\u677f\u5c06\u663e\u793a\u5728\u6a21\u677f\u5217\u8868\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6a21\u677f\u7248\u672c\u4e3a\u521a\u521a\u521b\u5efa\u7684\u7248\u672c",(0,i.kt)("inlineCode",{parentName:"li"},"v0.0.1"),"\u3002\n",(0,i.kt)("img",{alt:"template-version",src:a(22763).Z,width:"5106",height:"2530"})),(0,i.kt)("li",{parentName:"ol"},"\u5728 ",(0,i.kt)("inlineCode",{parentName:"li"},"\u8fd0\u7ef4\u4e2d\u5fc3")," \u7684 ",(0,i.kt)("inlineCode",{parentName:"li"},"\u8fde\u63a5\u5668"),"\u4e0b\u6dfb\u52a0\u963f\u91cc\u4e91\u8fde\u63a5\u5668\u3002"),(0,i.kt)("li",{parentName:"ol"},"\u914d\u7f6e\u963f\u91cc\u4e91\u8fde\u63a5\u5668\u5230\u73af\u5883."),(0,i.kt)("li",{parentName:"ol"},"\u4f7f\u7528\u6a21\u677f ",(0,i.kt)("inlineCode",{parentName:"li"},"aliyun-ec2")," \u521b\u5efa\u4e00\u4e2a\u670d\u52a1\uff0c \u8868\u5355\u7ec4\u548c\u6807\u7b7e\u7684\u6e32\u67d3\u662f\u6839\u636e\u4e0a\u8ff0\u6a21\u677f\u4e2d\u5b9a\u4e49\u7684\u53d8\u91cf\u6ce8\u91ca\u81ea\u52a8\u751f\u6210\u7684\u3002\n",(0,i.kt)("img",{alt:"create-service",src:a(27620).Z,width:"5104",height:"2262"}))),(0,i.kt)("p",null,"\u670d\u52a1\u521b\u5efa\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u670d\u52a1\u7684\u8be6\u60c5\u548c\u6a21\u677f\u7684\u8f93\u51fa\n",(0,i.kt)("img",{alt:"service-detail",src:a(23062).Z,width:"5120",height:"2530"}),"\n\u5728\u963f\u91cc\u4e91\u63a7\u5236\u53f0\u68c0\u67e5 ECS \u5b9e\u4f8b\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230 ECS \u5b9e\u4f8b\u5df2\u6210\u529f\u521b\u5efa\u3002\n",(0,i.kt)("img",{alt:"ecs-instance",src:a(28501).Z,width:"4686",height:"630"})))}p.isMDXComponent=!0},27620:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/create-service-81cc68242d43de727bcc6853f4fd920c.png"},35670:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/create-template-e812147213ca68acb0afdf863775cc60.png"},28501:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/ec2-39e0a99076faca2296c2c561028ec770.png"},23062:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/service-bab60e4283fbbd5cc58e7fb73a664e1d.png"},22763:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/template-version-25e96d8539b41d52f9b5c2fa61ed368c.png"}}]);