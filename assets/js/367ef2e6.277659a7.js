"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[26266],{22895:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>p});var n=a(87462),r=(a(67294),a(3905));const i={sidebar_position:4},l="Create Your First Template",o={unversionedId:"tutorials/create-first-template",id:"tutorials/create-first-template",title:"Create Your First Template",description:"This tutorial will guide you through the process of creating your first template and using it with Walrus. The example template will create a Kubernetes deployment resource.",source:"@site/docs/tutorials/create-first-template.md",sourceDirName:"tutorials",slug:"/tutorials/create-first-template",permalink:"/docs/tutorials/create-first-template",draft:!1,editUrl:"https://github.com/seal-io/docs/edit/main/docs/tutorials/create-first-template.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"docs",previous:{title:"Create a Catalog on GitHub",permalink:"/docs/tutorials/catalog-on-github"},next:{title:"Integration with CI/CD Tools",permalink:"/docs/tutorials/integrate-with-cicd"}},s={},p=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Create a repository on GitHub",id:"create-a-repository-on-github",level:2},{value:"Create Template Files",id:"create-template-files",level:2},{value:"Commit and Tag Version",id:"commit-and-tag-version",level:2},{value:"Template Icon",id:"template-icon",level:2},{value:"Template UI Schema",id:"template-ui-schema",level:2},{value:"Create a Template on Walrus",id:"create-a-template-on-walrus",level:2}],m={toc:p};function u(e){let{components:t,...i}=e;return(0,r.kt)("wrapper",(0,n.Z)({},m,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"create-your-first-template"},"Create Your First Template"),(0,r.kt)("p",null,"This tutorial will guide you through the process of creating your first template and using it with Walrus. The example template will create a Kubernetes deployment resource."),(0,r.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"A GitHub Repository for storing the template."),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"/deploy/standalone"},"Walrus installed"),".")),(0,r.kt)("h2",{id:"create-a-repository-on-github"},"Create a repository on GitHub"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Create your own new repository on GitHub. Here we are using the repository ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/walrus-catalog-demo/first-template"},"first-template")," as an example."),(0,r.kt)("li",{parentName:"ol"},"You can choose to create a new repository or fork the ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/walrus-catalog-demo/first-template"},"first-template")," repository.")),(0,r.kt)("h2",{id:"create-template-files"},"Create Template Files"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"mkdir first-template\ncd first-template\n")),(0,r.kt)("p",null,"Create the following files in the directory, the specific content of which can refer to ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/walrus-catalog-demo/first-template"},"first-template"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"- first-template\n\u251c\u2500\u2500 icon.svg\n\u251c\u2500\u2500 main.tf\n\u251c\u2500\u2500 outputs.tf\n\u251c\u2500\u2500 variables.tf\n...\n")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"main.tf")," file defines the resources to be created. Here we define a Kubernetes deployment resource for the template."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'resource "kubernetes_deployment" "example" {\n  metadata {\n    name = "example-deployment"\n    labels = {\n      app = "example"\n    }\n  }\n\n  spec {\n    replicas = 1\n    selector {\n      match_labels = {\n        app = "example"\n      }\n    }\n\n    template {\n      metadata {\n        labels = {\n          app = "example"\n        }\n      }\n\n      spec {\n        container {\n          image = var.image\n          name  = "example"\n        }\n      }\n    }\n  }\n}\n')),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"variables.tf")," file defines the variables used in the template. Walrus will use these variables to generate a template form. Here we define the image variable to specify the image of the Kubernetes deployment, you can define other variables as needed."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'variable "image" {\n  description = "The image to use for the Kubernetes deployment."\n  type        = string\n}\n')),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"outputs.tf")," file defines the output variables of the template. Once the resources are successfully created, Walrus will display the output variables on the resource details page. We have defined two output variables, ",(0,r.kt)("inlineCode",{parentName:"p"},"deployment_name")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"deployment_generation"),". You can define more output variables as needed, such as the ID and name of the resource."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'output "deployment_name" {\n  description = "The name of the Deployment."\n  value       = kubernetes_deployment.example.metadata[0].name\n}\n\noutput "deployment_generation" {\n  description = "The generation of the Deployment."\n  value       = kubernetes_deployment.example.metadata[0].generation\n}\n')),(0,r.kt)("p",null,"The README.md file is a description of the template. This file makes explanation of definitions of the template, parameters and outputs, which can be viewed on the template's details page after you import your own template in Walrus. You can use the tool ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/terraform-docs/terraform-docs"},"terraform-docs")," to generate the template description."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-markdown"},"terraform-docs markdown . > README.md\n")),(0,r.kt)("p",null,"The generated ",(0,r.kt)("inlineCode",{parentName:"p"},"README.md")," file is as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'## Requirements\n\nNo requirements.\n\n## Providers\n\n| Name | Version |\n|------|---------|\n| <a name="provider_kubernetes"></a> [kubernetes](#provider\\_kubernetes) | n/a |\n\n## Modules\n\nNo modules.\n\n## Resources\n\n| Name | Type |\n|------|------|\n| [kubernetes_deployment.example](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/deployment) | resource |\n\n## Inputs\n\n| Name | Description | Type | Default | Required |\n|------|-------------|------|---------|:--------:|\n| <a name="input_image"></a> [image](#input\\_image) | The image to use for the Kubernetes deployment. | `string` | n/a | yes |\n\n## Outputs\n\n| Name | Description |\n|------|-------------|\n| <a name="output_deployment_generation"></a> [deployment\\_generation](#output\\_deployment\\_generation) | The generation of the Deployment. |\n| <a name="output_deployment_name"></a> [deployment\\_name](#output\\_deployment\\_name) | The name of the Deployment. |\n\n')),(0,r.kt)("h2",{id:"commit-and-tag-version"},"Commit and Tag Version"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'git init\ngit add .\ngit commit -m "add template files"\ngit remote add origin https://github.com/yourname/first-template.git # replace with your repository address\ngit push -u origin main\n')),(0,r.kt)("p",null,"Create a tag for the template version."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"git tag v0.1.0\ngit push --tags\n")),(0,r.kt)("h2",{id:"template-icon"},"Template Icon"),(0,r.kt)("p",null,"The template icon of the template will be displayed on Walrus template list. You can create an icon.svg file in the current template directory as the template icon. The image file formats supported are svg, png, jpg, and jpeg. For example, you can add an icon.svg file to the template directory."),(0,r.kt)("p",null,"Commit the icon file to the repository."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'git add icon.svg\ngit commit -m "add icon.svg"\ngit push -u origin main\n')),(0,r.kt)("h2",{id:"template-ui-schema"},"Template UI Schema"),(0,r.kt)("p",null,"By default, Walrus will automatically generate form groups and label rendering based on the variables defined in the template. If you already have ",(0,r.kt)("a",{parentName:"p",href:"/docs/cli"},"Walrus cli")," installed, you can follow the ",(0,r.kt)("a",{parentName:"p",href:"/docs/cli/schema/walrus_schema_generate"},"Walrus schema generate")," to generate the schema file. You can follow the ",(0,r.kt)("a",{parentName:"p",href:"/operation/template#customizing-template-ui-schema"},"customizing-template-ui-schema")," to customize the form group and labels. After the schema file is generated, you can commit it to the repository and create a new tag for the template version."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'walrus schema generate --dir .\ngit add schema.yaml\ngit commit -m "add schema.yaml"\ngit push -u origin main\ngit tag v0.1.1\ngit push --tags\n')),(0,r.kt)("h2",{id:"create-a-template-on-walrus"},"Create a Template on Walrus"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Open Walrus in your browser and log in."),(0,r.kt)("li",{parentName:"ol"},"Go to the ",(0,r.kt)("inlineCode",{parentName:"li"},"Template")," tab under ",(0,r.kt)("inlineCode",{parentName:"li"},"Operations")," and create a template by using the template we just created, here we name the template ",(0,r.kt)("inlineCode",{parentName:"li"},"first-template"),".\n",(0,r.kt)("img",{alt:"create-template",src:a(43188).Z,width:"3360",height:"1670"}),"\nOnce the import task is completed, the template will be displayed in the template list. You can see that the template version is the newly created version v0.1.1.\n",(0,r.kt)("img",{alt:"template-version",src:a(78001).Z,width:"3342",height:"1662"})),(0,r.kt)("li",{parentName:"ol"},"Add k8s Provider in the ",(0,r.kt)("inlineCode",{parentName:"li"},"Connectors")," tab under ",(0,r.kt)("inlineCode",{parentName:"li"},"Operations"),".\n",(0,r.kt)("img",{alt:"add-connector",src:a(33414).Z,width:"3360",height:"1680"})),(0,r.kt)("li",{parentName:"ol"},"Configure the k8s connector to the environment where you want to create resources."),(0,r.kt)("li",{parentName:"ol"},"Create a resource using the template ",(0,r.kt)("inlineCode",{parentName:"li"},"first-template"),", the form is generated according to the template variables we defined.\n",(0,r.kt)("img",{alt:"create-resource",src:a(43586).Z,width:"3360",height:"1670"}),"\nAfter the resource is created, the details of the resource and the outputs of the template.\n",(0,r.kt)("img",{alt:"resource-detail",src:a(69070).Z,width:"3360",height:"1672"}),"\nCheck the k8s deployment, the deployment is created successfully.\n",(0,r.kt)("img",{alt:"ecs-rds",src:a(12105).Z,width:"2854",height:"942"}))))}u.isMDXComponent=!0},33414:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/add-connector-479ba8eec0c6649399cf9ad4e29add1c.png"},43586:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/create-resource-5987f1adf525623fd4f1397e1d4ff404.png"},43188:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/create-template-46aecd68508bc17e7bf088295af3cde2.png"},12105:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/rds-530327763efef7b40846f321e65eac97.png"},69070:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/resource-a8061c4d5966492c76fcd4e76eb3ae2b.png"},78001:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/template-version-a1812173d84116e092c38e792f389c89.png"}}]);