---
sidebar_position: 2
---

# 环境

> 注意:
> 自v0.4.0起，环境引入`环境类型`以增强管理。

环境是服务部署的目标。环境在项目下管理。

## 环境类型

> 注意:
> 目前不支持自定义环境类型。

在v0.4.0之前，不同环境之间的隔离是无法保证的，这意味着我们会遇到以下问题。

- 生产用途的[连接器](/operation/connector)可以由用于测试的环境引用。
- 普通开发人员可以将服务部署到生产环境中。

从v0.4.0开始，每个环境通过它的**类型**声明其用途，从而防止无法在该`环境类型`上进行操作（写入）的[用户](/users/user)操作该环境。值得注意的是，[连接器](/operation/connector) 也需要声明它适用于什么`环境类型`。

系统内置3种环境类型，它们分别是**开发**，**预发布**和**生产**。

- **开发**和**预发布**类型的环境可以被任何[用户](/users/user)操作。
- **生产**类型的环境仅可以被**主管**和**管理员**操作，**普通用户**处于只读状态。

通过使用环境类型，我们可以获得以下的隔离特性。

- 环境仅能关联同类型的[连接器](/operation/connector)。
- 项目[成员](/application/project#member-management)只能操作他们角色所能操作环境类型的环境，否则，他们会被视为[项目只读](/application/project#add-members)。

## 查看环境列表

1. 点击左侧导航栏中的`应用管理`，默认会进入第一个项目的视图。通过顶层面包屑可以切换项目。
2. 在环境标签页即可查看该项目下的环境列表。
3. 您可以在环境列表页的搜索框中输入关键词,快速搜索相关环境

## 创建环境

1. 通过查看环境列表的操作进入列表页面。
2. 点击`新建环境`，输入`名称`来标识您的环境。环境名称应该是唯一的,这样您可以轻易地在环境列表中找到该环境。

![qs-create-env](/img/v0.4.0/quickstart/qs-create-env.png)

3. 根据环境的实际情况，添加`环境标签`，`环境描述`。
4. 选择合适的`环境类型`。
5. 添加连接器，点击`添加连接器`，选择环境使用的连接器，点击`确定`按钮。
6. 点击`保存`按钮即可保存环境配置，您就可以在应用管理中使用这个环境了。

![qs-create-env2](/img/v0.4.0/quickstart/qs-create-env2.png)

## 编辑环境

1. 通过查看环境列表的操作进入列表页面。
2. 选择需要编辑的环境点击编辑按钮。
3. 根据需求修改环境的配置，添加或者删除连接器。
4. 点击`保存`按钮即可保存环境配置。

![app-env-edit](/img/v0.4.0/application/environment/app-env-edit.png)

## 管理服务

在环境中，您可以管理环境中的服务，包括添加服务，删除服务，修改服务配置等。
1. 点击导航栏中的`应用管理`，切换到对应的项目，选择进入需要管理的环境。
2. 在"服务"标签页，查看环境中的服务列表。
3. 点击`新建服务`，选择需要添加的服务，填写相应信息，点击`保存`按钮即可完成添加服务。
5. 点击服务列表中的`删除`操作，即可删除环境中的服务。

更多服务管理详情，请参见[服务](/application/service)。

## 依赖图

在环境中,不同的服务之间可以有依赖关系。您可以通过依赖图查看服务之间的依赖关系,同时也可以查看环境中所有的服务及其资源。在依赖图中，某些资源可以操作，通过资源卡片右上角进行更多操作。例如，您可以在依赖图中对资源查看日志或者执行终端任务。

更多依赖图详情，请参见[依赖图](/application/graph)。

![app-env-graph](/img/v0.4.0/application/environment/app-env-graph.png)

![app-env-graph-res](/img/v0.4.0/application/environment/app-env-graph-res.png)

## 环境变量

环境变量是一种存储在环境中的键值对，可以在环境的服务中引用。 环境变量在创建或者编辑部署服务时，在配置模块中的相关参数时使用。当前环境的变量只能在当前环境中使用，不同环境的变量是相互独立的。
> 如果项目或全局存在同名的变量,则环境中定义的变量值会覆盖项目或全局变量的值。

![app/env-var](/img/v0.4.0/application/environment/app-env-var.png)

使用方法：在创建服务时，在需要使用变量的输入框中输入`${var.环境变量名称}`

更多变量详情，请参见[变量](/operation/variable)。

## 克隆环境

在某些场景下，您可能需要创建一个与现有环境相同的环境，这时您可以使用克隆环境功能。克隆环境可以根据现有环境的配置及服务，快速创建一个新的环境。
1. 点击导航栏中的`应用管理`->`环境`菜单进入到环境列表。
2. 在环境列表中选择需要克隆的环境，点击`克隆`操作。

![app-env-clone](/img/v0.4.0/application/environment/app-env-clone.png)

3. 配置克隆环境的名称、描述、标签等信息,选择连接器。
4. 根据需要修改克隆环境中服务的配置，点击选中服务，在弹窗中可修改服务配置，点击`确定`保存修改，然后点击`保存`按钮即可完成克隆环境。

![app-env-clone-details](/img/v0.4.0/application/environment/app-env-clone-details.png)

5. 克隆环境创建完成后，您可以在应用管理中使用这个环境了，被克隆的服务也会自动根据依赖关系自动编排部署，您可以在服务列表中查看服务的状态。

![app-env-clone-deploy](/img/v0.4.0/application/environment/app-env-clone-deploy.png)

## 删除环境

1. 点击导航栏中的`应用管理`->`环境`菜单进入到环境列表。
2. 确保没有服务依赖于该环境后，勾选您需要删除的环境，点击`删除`操作即可完成删除。
